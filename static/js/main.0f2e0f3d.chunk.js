(this["webpackJsonpsvg-experiments"]=this["webpackJsonpsvg-experiments"]||[]).push([[0],{174:function(module,__webpack_exports__,__webpack_require__){"use strict";var _home_runner_work_svg_experiments_svg_experiments_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(109),_home_runner_work_svg_experiments_svg_experiments_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(78),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8),react__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__),_App_css__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(383),_App_css__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_App_css__WEBPACK_IMPORTED_MODULE_3__),MARGIN_TOP=5,MARGIN_SIDE=5,ELEMENT_WIDTH=150,ELEMENT_HEIGHT=40,SYMBOL_WIDTH=12,SYMBOL_SPACING=3,GROUP_MARGIN_TOP=30,GROUP_MARGIN_BOTTOM=10,GROUP_MARGIN_SIDE=10,HORIZONTAL_SPACING=10,VERTICAL_SPACING=20,TEXT_PADDING=5,EDGE_SPACING=10,STROKE_WIDTH=.5;function width(e){switch(e.kind){case"stack":return Math.max.apply(Math,Object(_home_runner_work_svg_experiments_svg_experiments_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(e.elements.map(width)));case"layer":return e.elements.map(width).map((function(e,t){return e+(t>0?HORIZONTAL_SPACING:0)})).reduce((function(e,t){return e+t}),0);case"group":return e.elements.map(width).map((function(e,t){return e+(t>0?HORIZONTAL_SPACING:0)})).reduce((function(e,t){return e+t}),0)+2*GROUP_MARGIN_SIDE;case"node":return ELEMENT_WIDTH*(e.size||1)}}function heightOfNodes(e){var t=e.elements.length;return t*ELEMENT_HEIGHT+t*VERTICAL_SPACING+t*GROUP_MARGIN_TOP+t*GROUP_MARGIN_BOTTOM}function fromIsUpper(e){return e.from.layerIndex===e.to.layerIndex?e.from.index<=e.to.index:e.from.layerIndex<e.to.layerIndex}function getUpperNode(e){return fromIsUpper(e)?e.from:e.to}function getLowerNode(e){return fromIsUpper(e)?e.to:e.from}function heightOfEdges(e,t){var n=new Map;return e.forEach((function(e){var t=getUpperNode(e).layerIndex,r=n.get(t)||[];r.push(e),n.set(t,r)})),Array.from(Array(t).keys()).map((function(e){var t,r=(null===(t=n.get(e))||void 0===t?void 0:t.map((function(e){return e.index})))||[0];return Math.max.apply(Math,Object(_home_runner_work_svg_experiments_svg_experiments_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(r))*EDGE_SPACING}))}function addLayerPositionToNodeG(e){return{stack:addLayerPositionToNode(e.stack),edges:e.edges}}function numberOfElements(e){switch(e.kind){case"stack":return Math.max.apply(Math,Object(_home_runner_work_svg_experiments_svg_experiments_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(e.elements.map(numberOfElements)));case"layer":case"group":return e.elements.map(numberOfElements).reduce((function(e,t){return e+t}),0);case"node":return 1}}function addLayerPositionToNode(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{index:0};switch(e.kind){case"stack":var o=numberOfElements(e);return Object.assign(e,{elements:e.elements.map((function(e,t){return addLayerPositionToNode(e,o,t)}))});case"layer":var _=numberOfElements(e),s=(t-_)/2,d=[],l={index:0};return e.elements.forEach((function(e){var r=addLayerPositionToNode(e,t,n,s,l);d.push(r)})),Object.assign(e,{elements:d});case"group":return Object.assign(e,{elements:e.elements.map((function(e){return addLayerPositionToNode(e,t,n,r,a)}))});case"node":var i=Object.assign(e,{key:n+"_"+a.index,index:a.index,relativePosition:r+a.index,layerIndex:n});return a.index++,i}}function addCoordinatesToNodeG(e){var t=heightOfEdges(e.edges,e.stack.elements.length);return addCoordinatesToNode(e.stack,{x:0},t),e}function addCoordinatesToNode(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;switch(e.kind){case"stack":var o=width(e);return void e.elements.forEach((function(e,r){var a=n.slice(0,r).reduce((function(e,t){return e+t}),0);addCoordinatesToNode(e,t,n,o,a)}));case"layer":return t.x=MARGIN_SIDE+(r-width(e))/2,void e.elements.forEach((function(e){addCoordinatesToNode(e,t,n,r,a)}));case"group":return t.x+=GROUP_MARGIN_SIDE,e.elements.forEach((function(e){addCoordinatesToNode(e,t,n,r,a)})),void(t.x+=GROUP_MARGIN_SIDE);case"node":return Object.assign(e,{x:t.x,y:MARGIN_TOP+GROUP_MARGIN_TOP+e.layerIndex*(ELEMENT_HEIGHT+VERTICAL_SPACING+GROUP_MARGIN_TOP+GROUP_MARGIN_BOTTOM)+a}),void(t.x+=ELEMENT_WIDTH*(e.size||1)+HORIZONTAL_SPACING)}}function addLayerPositionToEdgeG(e){return addLayerPositionToEdge(e.edges),{stack:e.stack,edges:e.edges}}function addLayerPositionToEdge(e){var t=new Map;e.forEach((function(e){var n=getUpperNode(e).layerIndex,r=t.get(n)||[];r.push(e),t.set(n,r)})),Array.from(t.values()).forEach(addLayerPositionToEdgeForLayer)}function addLayerPositionToEdgeForLayer(e){var t=new Map;e.forEach((function(e){var n=getUpperNode(e).key,r=t.get(n)||[];r.push(e),t.set(n,r)}));var n=Array.from(t.keys());n.sort();var r=0;n.forEach((function(e){var n=t.get(e),a=n.filter((function(e){return getLowerNode(e).layerIndex===getUpperNode(e).layerIndex})),o=a.filter((function(e){return getLowerNode(e).index<=getUpperNode(e).index})),_=a.filter((function(e){return getLowerNode(e).index>getUpperNode(e).index})),s=n.filter((function(e){return getLowerNode(e).layerIndex!==getUpperNode(e).layerIndex})),d=s.filter((function(e){return getLowerNode(e).relativePosition<=getUpperNode(e).relativePosition})),l=s.filter((function(e){return getLowerNode(e).relativePosition>getUpperNode(e).relativePosition}));o.sort((function(e,t){return getLowerNode(e).index-getLowerNode(t).index})),d.sort((function(e,t){return getLowerNode(e).index-getLowerNode(t).index})),l.sort((function(e,t){return getLowerNode(t).index-getLowerNode(e).index})),_.sort((function(e,t){return getLowerNode(e).index-getLowerNode(t).index}));var i=o.concat(d),m=_.concat(l);function c(t,n,a){var o=getUpperNode(t).layerIndex,_=r+n;Object.assign(t,{key:e+"_"+a+"_"+_,index:_,layerIndex:o})}i.forEach((function(e,t){return c(e,t,"B")})),m.forEach((function(e,t){return c(e,t,"A")})),r+=Math.max(i.length,m.length)}))}function addConnectionIndexAndNumberOfEdgesG(e){return addConnectionIndexAndNumberOfEdges(e.edges),{stack:e.stack,edges:e.edges}}function addConnectionIndexAndNumberOfEdges(e){var t=new Map;function n(e,n,r){var a=e.layerIndex<=n.layerIndex?"LOWER":"UPPER",o=e.key+a,_=t.get(o)||{node:e,side:a,edgeEnds:[]};_.edgeEnds.push({reverseNode:n,setIndex:r}),t.set(o,_)}e.forEach((function(e){n(e.from,e.to,(function(t){return Object.assign(e,{fromIndex:t})})),n(e.to,e.from,(function(t){return Object.assign(e,{toIndex:t})}))})),Array.from(t.values()).forEach((function(e){var t=e.edgeEnds,n=e.node,r=e.side,a=t.filter((function(e){return e.reverseNode.layerIndex===n.layerIndex})),o=a.filter((function(e){return e.reverseNode.index<=n.index})),_=a.filter((function(e){return e.reverseNode.index>=n.index})),s=t.filter((function(e){return e.reverseNode.layerIndex!==n.layerIndex}));o.sort((function(e,t){return t.reverseNode.index-e.reverseNode.index})),s.sort((function(e,t){return e.reverseNode.index-t.reverseNode.index})),_.sort((function(e,t){return t.reverseNode.index-e.reverseNode.index})),o.concat(s).concat(_).forEach((function(e,t){e.setIndex(t)})),"UPPER"===r?Object.assign(n,{upperSideEdges:t.length}):Object.assign(n,{lowerSideEdges:t.length})}))}function addPositionToGroupG(e){return{stack:addPositionToGroup(e.stack),edges:e.edges}}function addPositionToGroup(e){return{kind:"stack",elements:e.elements.map((function(e,t){return{kind:e.kind,elements:e.elements.map((function(e,n){return Object.assign(e,{key:"G_"+t+"_"+n,index:n,layerIndex:t})}))}}))}}var ComponentSymbol=function(e){var t=.4*e.width,n=.15*e.width;return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("g",{key:e.symbolKey},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("rect",{x:e.x+t/2,y:e.y,width:.8*e.width,height:1.1*e.width,fill:"none",strokeWidth:STROKE_WIDTH,stroke:"black"}),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("rect",{x:e.x,y:e.y+n,width:t,height:n,fill:"lightgrey",strokeWidth:STROKE_WIDTH,stroke:"black"}),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("rect",{x:e.x,y:e.y+3*n,width:t,height:n,fill:"lightgrey",strokeWidth:STROKE_WIDTH,stroke:"black"}))},Rect=function(e){var t="component"===e.symbol;return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("g",{key:e.key},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("rect",{"data-testid":"rect",x:e.x,y:e.y,width:width(e),height:ELEMENT_HEIGHT,fill:"lightgrey",strokeWidth:STROKE_WIDTH,stroke:"black"}),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("text",{x:e.x+TEXT_PADDING,y:e.y+ELEMENT_HEIGHT/2,fill:"black",clipPath:"url(#clip-element-text-"+e.key+")"},e.name),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("clipPath",{id:"clip-element-text-"+e.key},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("rect",{x:e.x+TEXT_PADDING,y:e.y,width:width(e)-2*TEXT_PADDING-(t?SYMBOL_WIDTH+SYMBOL_SPACING:0),height:ELEMENT_HEIGHT})),t?react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(ComponentSymbol,{symbolKey:e.key+"CS",x:e.x+width(e)-SYMBOL_WIDTH-SYMBOL_SPACING,y:e.y+SYMBOL_SPACING,width:SYMBOL_WIDTH}):"")},Group=function(e){var t=e.elements.filter((function(e){return"node"===e.kind}))[0],n=t.x-GROUP_MARGIN_SIDE,r=t.y-GROUP_MARGIN_TOP;return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("g",{key:e.key},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("rect",{x:n,y:r,width:width(e),height:ELEMENT_HEIGHT+GROUP_MARGIN_TOP+GROUP_MARGIN_BOTTOM,fill:"none",strokeWidth:STROKE_WIDTH,stroke:"grey"}),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("text",{x:n+GROUP_MARGIN_SIDE,y:r+ELEMENT_HEIGHT/2,fill:"black",clipPath:"url(#clip-element-text-"+e.key+")"},e.name),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("clipPath",{id:"clip-element-text-"+e.key},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("rect",{x:n+GROUP_MARGIN_SIDE,y:r,width:width(e)-2*GROUP_MARGIN_SIDE,height:ELEMENT_HEIGHT})))};function edgeEndCoordinates(e,t,n){var r=e.layerIndex<=n.layerIndex,a=(width(e)-((r?e.lowerSideEdges:e.upperSideEdges)-1)*EDGE_SPACING)/2;return{x:e.x+a+t*EDGE_SPACING,y:e.y+(r?ELEMENT_HEIGHT:0)}}var Path=function(e){var t=edgeEndCoordinates(e.from,e.fromIndex,e.to),n=getUpperNode(e).y+ELEMENT_HEIGHT+VERTICAL_SPACING/2+GROUP_MARGIN_BOTTOM+e.index*EDGE_SPACING,r=edgeEndCoordinates(e.to,e.toIndex,e.from);return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("path",{key:e.key,d:"M "+t.x+" "+t.y+" L "+t.x+" "+n+" L "+r.x+" "+n+" L "+r.x+" "+r.y,stroke:"black",strokeWidth:STROKE_WIDTH,fill:"none"})};function convertStringsToNodes(e){return{kind:"group",name:e.name,elements:e.elements.map((function(e){return"string"===typeof e?{kind:"node",name:e}:"elements"in e?convertStringsToNodes(e):Object.assign(e,{kind:"node"})}))}}function stringsToNodes(e){return{kind:"stack",elements:e.map((function(e){return{kind:"layer",elements:e.map(convertStringsToNodes)}}))}}var graphAsString='var stack = stringsToNodes([\n    [\n        {name: "group 1", elements: [\n            "element 11", \n            {name: "element 2", size: 1.5, symbol: "component"}, \n            {name: "an element with long text", symbol: "component"}            \n        ]},\n        {name: "group 2", elements: ["element 4"]}\n    ],\n    [\n        {name: "group 3", elements: ["element 1", "element 2"]},\n        {name: "group 4", elements: ["element 3"]}\n    ],\n    [\n        {name: "group 5", elements: [\n            "element 1", "element 2", "element 3", \n            {name: "element with changed name", size: 1.5}, \n            {name: "element 5", size: 0.7}]}\n    ]\n]);\nvar layers = stack.elements;\n\nvar edges = [\n    {from: layers[0].elements[0].elements[1], to: layers[1].elements[0].elements[0]},\n    {from: layers[0].elements[0].elements[2], to: layers[1].elements[1].elements[0]},\n    {from: layers[0].elements[1].elements[0], to: layers[1].elements[0].elements[1]},\n    {from: layers[1].elements[1].elements[0], to: layers[2].elements[0].elements[2]},\n    {from: layers[1].elements[0].elements[1], to: layers[2].elements[0].elements[4]},\n    {from: layers[1].elements[0].elements[1], to: layers[2].elements[0].elements[3]},\n    {from: layers[1].elements[0].elements[1], to: layers[2].elements[0].elements[2]},\n    {from: layers[1].elements[0].elements[1], to: layers[2].elements[0].elements[1]},\n    {from: layers[1].elements[0].elements[1], to: layers[2].elements[0].elements[0]},\n    {from: layers[2].elements[0].elements[0], to: layers[1].elements[0].elements[0]},\n    {from: layers[2].elements[0].elements[1], to: layers[1].elements[0].elements[0]},\n    {from: layers[2].elements[0].elements[0], to: layers[2].elements[0].elements[3]},\n    {from: layers[2].elements[0].elements[1], to: layers[2].elements[0].elements[3]},\n    {from: layers[2].elements[0].elements[4], to: layers[2].elements[0].elements[3]},\n    {from: layers[0].elements[0].elements[0], to: layers[0].elements[0].elements[2]},\n    {from: layers[0].elements[0].elements[0], to: layers[0].elements[0].elements[1]},\n    {from: layers[0].elements[0].elements[0], to: layers[1].elements[0].elements[0]},\n    {from: layers[0].elements[0].elements[0], to: layers[1].elements[0].elements[0]},\n    {from: layers[1].elements[0].elements[1], to: layers[1].elements[0].elements[0]},\n    {from: layers[1].elements[0].elements[1], to: layers[1].elements[1].elements[0]}\n];\n\nvar graph = {\n    stack: stack,\n    edges: edges\n};\n\ngraph\n',initialGraph=eval(graphAsString);function allNodes(e){switch(e.kind){case"stack":return e.elements.flatMap((function(e){return e.elements})).flatMap(allNodes);case"group":return e.elements.flatMap(allNodes);case"node":return[e]}}var Diagram=function(e){return[e].map(addLayerPositionToNodeG).map(addLayerPositionToEdgeG).map(addCoordinatesToNodeG).map(addConnectionIndexAndNumberOfEdgesG).map(addPositionToGroupG).map((function(e){var t=heightOfEdges(e.edges,e.stack.elements.length),n=width(e.stack)+2*MARGIN_SIDE,r=heightOfNodes(e.stack)+t.reduce((function(e,t){return e+t}))+2*MARGIN_TOP;return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("svg",{viewBox:"0 0 "+n+" "+r},allNodes(e.stack).map(Rect),e.stack.elements.flatMap((function(e){return e.elements})).map(Group),e.edges.map(Path))}))[0]};function parseGraph(text){try{var graph=eval(text);if(void 0===graph)return"Script is not returning a graph object!";if(void 0===graph.stack)return"Property layers is missing in graph object!";if(void 0===graph.edges)return"Property edges is missing in graph object!";for(var layers=graph.stack.elements,aNodeIsUndefined=!1,layerIndex=0;layerIndex<layers.length;layerIndex++)for(var groups=layers[layerIndex].elements,groupIndex=0;groupIndex<groups.length;groupIndex++)for(var elements=groups[groupIndex].elements,elementIndex=0;elementIndex<elements.length;elementIndex++)void 0===elements[elementIndex]&&(aNodeIsUndefined=!0);return aNodeIsUndefined?"Every node must be defined!":graph.edges.every((function(e){return void 0!==e.from}))?graph.edges.every((function(e){return void 0!==e.to}))?graph:"Property to must be defined on every edge!":"Property from must be defined on every edge!"}catch(e){return e.message}}var App=function(){var e=Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(initialGraph),t=Object(_home_runner_work_svg_experiments_svg_experiments_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(e,2),n=t[0],r=t[1],a=Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(""),o=Object(_home_runner_work_svg_experiments_svg_experiments_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(a,2),_=o[0],s=o[1];return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("div",{id:"parent",className:"App"},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("div",{id:"graph"},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Diagram,{stack:n.stack,edges:n.edges})),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("textarea",{cols:100,rows:45,onChange:function(e){var t=parseGraph(e.target.value);"string"===typeof t?s(t):(r(t),s(""))},defaultValue:graphAsString}),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("p",{className:"error-message"},_)))};__webpack_exports__.a=App},175:function(e,t,n){e.exports=n(384)},382:function(e,t,n){},383:function(e,t,n){},384:function(e,t,n){"use strict";n.r(t);n(176),n(185);var r=n(8),a=n.n(r),o=n(173),_=n.n(o),s=(n(382),n(174));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));_.a.render(a.a.createElement(s.a,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[175,1,2]]]);
//# sourceMappingURL=main.0f2e0f3d.chunk.js.map