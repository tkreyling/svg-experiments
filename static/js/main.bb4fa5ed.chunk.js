(this["webpackJsonpsvg-experiments"]=this["webpackJsonpsvg-experiments"]||[]).push([[0],[,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";var _home_runner_work_svg_experiments_svg_experiments_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_home_runner_work_svg_experiments_svg_experiments_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__),_App_css__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(12),_App_css__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_App_css__WEBPACK_IMPORTED_MODULE_3__),MARGIN_TOP=5,MARGIN_SIDE=5,ELEMENT_WIDTH=150,ELEMENT_HEIGHT=40,HORIZONTAL_SPACING=10,VERTICAL_SPACING=20,TEXT_PADDING=5,EDGE_SPACING=10;function widthOfLayers(e){return Math.max.apply(Math,Object(_home_runner_work_svg_experiments_svg_experiments_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(e.map(widthOfElements)))}function widthOfElements(e){var r=e.map((function(e){return e.length})).reduce((function(e,r){return e+r}),0);return 0===r?0:r*ELEMENT_WIDTH+(r-1)*HORIZONTAL_SPACING}function heightOfNodes(e){var r=e.length;return r*ELEMENT_HEIGHT+r*VERTICAL_SPACING}function fromIsUpper(e){return e.from.layerIndex===e.to.layerIndex?e.from.index<=e.to.index:e.from.layerIndex<e.to.layerIndex}function getUpperNode(e){return fromIsUpper(e)?e.from:e.to}function getLowerNode(e){return fromIsUpper(e)?e.to:e.from}function heightOfEdges(e,r){var n=new Map;return e.forEach((function(e){var r=getUpperNode(e).layerIndex,t=n.get(r)||[];t.push(e),n.set(r,t)})),Array.from(Array(r).keys()).map((function(e){var r,t=(null===(r=n.get(e))||void 0===r?void 0:r.map((function(e){return e.index})))||[0];return Math.max.apply(Math,Object(_home_runner_work_svg_experiments_svg_experiments_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(t))*EDGE_SPACING}))}function addLayerPositionToNodeG(e){return{layers:addLayerPositionToNode(e.layers),edges:e.edges}}function addLayerPositionToNode(e){var r=Math.max.apply(Math,Object(_home_runner_work_svg_experiments_svg_experiments_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(e.map((function(e){return e.map((function(e){return e.length})).reduce((function(e,r){return e+r}),0)}))));return e.map((function(e,n){return addLayerPositionToNodeForLayer(e,r,n)}))}function addLayerPositionToNodeForLayer(e,r,n){var t=(r-e.map((function(e){return e.length})).reduce((function(e,r){return e+r}),0))/2,o=[],a=0;return e.forEach((function(e){var r=e.map((function(e){var r=Object.assign(e,{key:n+"_"+a,index:a,relativePosition:t+a,layerIndex:n});return a++,r}));o.push(r)})),o}function addCoordinatesToNodeG(e){var r=heightOfEdges(e.edges,e.layers.length);return{layers:layout(e.layers,r),edges:e.edges}}function layout(e,r){var n=widthOfLayers(e);return e.map((function(e,t){var o=r.slice(0,t).reduce((function(e,r){return e+r}),0);return layoutHorizontally(e,n,o)}))}function layoutHorizontally(e,r,n){var t=(r-widthOfElements(e))/2;return e.map((function(e){return e.map((function(e){return Object.assign(e,{x:e.index*(ELEMENT_WIDTH+HORIZONTAL_SPACING)+MARGIN_SIDE+t,y:e.layerIndex*(ELEMENT_HEIGHT+VERTICAL_SPACING)+MARGIN_TOP+n})}))}))}function addLayerPositionToEdgeG(e){return addLayerPositionToEdge(e.edges),{layers:e.layers,edges:e.edges}}function addLayerPositionToEdge(e){var r=new Map;e.forEach((function(e){var n=getUpperNode(e).layerIndex,t=r.get(n)||[];t.push(e),r.set(n,t)})),Array.from(r.values()).forEach(addLayerPositionToEdgeForLayer)}function addLayerPositionToEdgeForLayer(e){var r=new Map;e.forEach((function(e){var n=getUpperNode(e).key,t=r.get(n)||[];t.push(e),r.set(n,t)}));var n=Array.from(r.keys());n.sort();var t=0;n.forEach((function(e){var n=r.get(e),o=n.filter((function(e){return getLowerNode(e).layerIndex===getUpperNode(e).layerIndex})),a=o.filter((function(e){return getLowerNode(e).index<=getUpperNode(e).index})),_=o.filter((function(e){return getLowerNode(e).index>getUpperNode(e).index})),s=n.filter((function(e){return getLowerNode(e).layerIndex!==getUpperNode(e).layerIndex})),d=s.filter((function(e){return getLowerNode(e).relativePosition<=getUpperNode(e).relativePosition})),i=s.filter((function(e){return getLowerNode(e).relativePosition>getUpperNode(e).relativePosition}));a.sort((function(e,r){return getLowerNode(e).index-getLowerNode(r).index})),d.sort((function(e,r){return getLowerNode(e).index-getLowerNode(r).index})),i.sort((function(e,r){return getLowerNode(r).index-getLowerNode(e).index})),_.sort((function(e,r){return getLowerNode(e).index-getLowerNode(r).index}));var l=a.concat(d),u=_.concat(i);function E(r,n,o){var a=getUpperNode(r).layerIndex,_=t+n;Object.assign(r,{key:e+"_"+o+"_"+_,index:_,layerIndex:a})}l.forEach((function(e,r){return E(e,r,"B")})),u.forEach((function(e,r){return E(e,r,"A")})),t+=Math.max(l.length,u.length)}))}function addConnectionIndexAndNumberOfEdgesG(e){return addConnectionIndexAndNumberOfEdges(e.edges),{layers:e.layers,edges:e.edges}}function addConnectionIndexAndNumberOfEdges(e){var r=new Map;function n(e,n,t){var o=e.layerIndex<=n.layerIndex?"LOWER":"UPPER",a=e.key+o,_=r.get(a)||{node:e,side:o,edgeEnds:[]};_.edgeEnds.push({reverseNode:n,setIndex:t}),r.set(a,_)}e.forEach((function(e){n(e.from,e.to,(function(r){return Object.assign(e,{fromIndex:r})})),n(e.to,e.from,(function(r){return Object.assign(e,{toIndex:r})}))})),Array.from(r.values()).forEach((function(e){var r=e.edgeEnds,n=e.node,t=e.side,o=r.filter((function(e){return e.reverseNode.layerIndex===n.layerIndex})),a=o.filter((function(e){return e.reverseNode.index<=n.index})),_=o.filter((function(e){return e.reverseNode.index>=n.index})),s=r.filter((function(e){return e.reverseNode.layerIndex!==n.layerIndex}));a.sort((function(e,r){return r.reverseNode.index-e.reverseNode.index})),s.sort((function(e,r){return e.reverseNode.index-r.reverseNode.index})),_.sort((function(e,r){return r.reverseNode.index-e.reverseNode.index})),a.concat(s).concat(_).forEach((function(e,r){e.setIndex(r)})),"UPPER"===t?Object.assign(n,{upperSideEdges:r.length}):Object.assign(n,{lowerSideEdges:r.length})}))}var Rect=function(e){return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("g",{key:e.key},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("rect",{"data-testid":"rect",x:e.x,y:e.y,width:ELEMENT_WIDTH,height:ELEMENT_HEIGHT,fill:"lightgrey",strokeWidth:1,stroke:"black"}),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("text",{x:e.x+TEXT_PADDING,y:e.y+ELEMENT_HEIGHT/2,fill:"black",clipPath:"url(#clip-element-text-"+e.key+")"},e.name),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("clipPath",{id:"clip-element-text-"+e.key},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("rect",{x:e.x+TEXT_PADDING,y:e.y,width:ELEMENT_WIDTH-2*TEXT_PADDING,height:ELEMENT_HEIGHT})))},Path=function(e){var r=e.from.layerIndex<=e.to.layerIndex,n=(ELEMENT_WIDTH-((r?e.from.lowerSideEdges:e.from.upperSideEdges)-1)*EDGE_SPACING)/2,t=e.from.x+n+e.fromIndex*EDGE_SPACING,o=e.from.y+(r?ELEMENT_HEIGHT:0),a=getUpperNode(e).y+ELEMENT_HEIGHT+VERTICAL_SPACING/2+e.index*EDGE_SPACING,_=e.from.layerIndex>=e.to.layerIndex,s=(ELEMENT_WIDTH-((_?e.to.lowerSideEdges:e.to.upperSideEdges)-1)*EDGE_SPACING)/2,d=e.to.x+s+e.toIndex*EDGE_SPACING,i=e.to.y+(_?ELEMENT_HEIGHT:0);return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("path",{key:e.key,d:"M "+t+" "+o+" L "+t+" "+a+" L "+d+" "+a+" L "+d+" "+i,stroke:"black",strokeWidth:1,fill:"none"})};function stringsToNodes(e){return e.map((function(e){return e.map((function(e){return e.map((function(e){return{name:e}}))}))}))}var graphAsString='var layers = stringsToNodes([\n    [["element 11", "element 2", "an element with long text"], ["element 4"]],\n    [["element 1", "element 2", "element 3"]],\n    [["element 1", "element 2", "element 3", "element with changed name", "element 5"]]\n]);\n\nvar edges = [\n    {from: layers[0][0][1], to: layers[1][0][0]},\n    {from: layers[0][0][2], to: layers[1][0][2]},\n    {from: layers[0][1][0], to: layers[1][0][1]},\n    {from: layers[1][0][2], to: layers[2][0][2]},\n    {from: layers[1][0][1], to: layers[2][0][4]},\n    {from: layers[1][0][1], to: layers[2][0][3]},\n    {from: layers[1][0][1], to: layers[2][0][2]},\n    {from: layers[1][0][1], to: layers[2][0][1]},\n    {from: layers[1][0][1], to: layers[2][0][0]},\n    {from: layers[2][0][0], to: layers[1][0][0]},\n    {from: layers[2][0][1], to: layers[1][0][0]},\n    {from: layers[2][0][0], to: layers[2][0][3]},\n    {from: layers[2][0][1], to: layers[2][0][3]},\n    {from: layers[2][0][4], to: layers[2][0][3]},\n    {from: layers[0][0][0], to: layers[0][0][2]},\n    {from: layers[0][0][0], to: layers[0][0][1]},\n    {from: layers[0][0][0], to: layers[1][0][0]},\n    {from: layers[0][0][0], to: layers[1][0][0]},\n    {from: layers[1][0][1], to: layers[1][0][0]},\n    {from: layers[1][0][1], to: layers[1][0][2]}\n];\n\nvar graph = {\n    layers: layers,\n    edges: edges\n};\n\ngraph\n',initialGraph=eval(graphAsString),Diagram=function(e){return[e].map(addLayerPositionToNodeG).map(addLayerPositionToEdgeG).map(addCoordinatesToNodeG).map(addConnectionIndexAndNumberOfEdgesG).map((function(e){var r=heightOfEdges(e.edges,e.layers.length),n=widthOfLayers(e.layers)+2*MARGIN_SIDE,t=heightOfNodes(e.layers)+r.reduce((function(e,r){return e+r}))+2*MARGIN_TOP;return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("svg",{viewBox:"0 0 "+n+" "+t},e.layers.flat().flat().map(Rect),e.edges.map(Path))}))[0]};function parseGraph(text){try{var graph=eval(text);if(void 0===graph)return"Script is not returning a graph object!";if(void 0===graph.layers)return"Property layers is missing in graph object!";if(void 0===graph.edges)return"Property edges is missing in graph object!";for(var layers=graph.layers,aNodeIsUndefined=!1,layerIndex=0;layerIndex<layers.length;layerIndex++)for(var groups=layers[layerIndex],groupIndex=0;groupIndex<groups.length;groupIndex++)for(var elements=groups[groupIndex],elementIndex=0;elementIndex<elements.length;elementIndex++)void 0===elements[elementIndex]&&(aNodeIsUndefined=!0);return aNodeIsUndefined?"Every node must be defined!":graph.edges.every((function(e){return void 0!==e.from}))?graph.edges.every((function(e){return void 0!==e.to}))?graph:"Property to must be defined on every edge!":"Property from must be defined on every edge!"}catch(e){return e.message}}var App=function(){var e=Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(initialGraph),r=Object(_home_runner_work_svg_experiments_svg_experiments_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(e,2),n=r[0],t=r[1],o=Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(""),a=Object(_home_runner_work_svg_experiments_svg_experiments_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(o,2),_=a[0],s=a[1];return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("div",{id:"parent",className:"App"},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("div",{id:"graph"},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Diagram,{layers:n.layers,edges:n.edges})),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("textarea",{cols:100,rows:45,onChange:function(e){var r=parseGraph(e.target.value);"string"===typeof r?s(r):(t(r),s(""))},defaultValue:graphAsString}),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("p",{className:"error-message"},_)))};__webpack_exports__.a=App},function(e,r,n){e.exports=n(13)},,,,,function(e,r,n){},function(e,r,n){},function(e,r,n){"use strict";n.r(r);var t=n(0),o=n.n(t),a=n(4),_=n.n(a),s=(n(11),n(5));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));_.a.render(o.a.createElement(s.a,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[6,1,2]]]);
//# sourceMappingURL=main.bb4fa5ed.chunk.js.map